<!-- 
View Survey Response (Read-Only)
This page allows a user (or manager) to look back at a completed survey.
It looks almost identical to the survey form, but:
1. All inputs are 'disabled' (greyed out) so they can't be changed.
2. The values are pre-filled with what the user originally selected.
3. The "Submit" button is replaced with a "Back" button.
-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <%- include('partials/head') %>
    <title>Your Feedback - Ella Rises</title>
    
    <!-- Fonts matching your events page -->
    <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display&family=Montserrat:wght@400;500;700&display=swap" rel="stylesheet">
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/styles.css">

    <style>
        /* Custom tweaks to make the read-only form look nice */
        .rating-label {
            font-weight: 600;
            margin-bottom: 0.5rem;
            display: block;
        }
        .scale-labels {
            font-size: 0.75rem;
            color: #6c757d;
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-weight: 500;
        }
        /* Make the selected option stand out (Solid Green) */
        .form-check-input:checked {
            background-color: #198754; 
            border-color: #198754;
            opacity: 1; 
        }
        /* Make unselected options fade out so the user's choice is obvious */
        .form-check-input:disabled:not(:checked) {
            opacity: 0.4;
        }
    </style>
</head>
<body class="bg-light">

    <%- include('partials/navbar') %>

    <div class="container py-5">
        <div class="row justify-content-center">
            <div class="col-lg-9 col-xl-8">
                
                <div class="card shadow-sm border-0 rounded-3">
                    <div class="card-body p-4 p-md-5">
                        
                        <div class="text-center mb-4">
                            <h2 style="font-family: 'DM Serif Display', serif;">Your Feedback</h2>
                            <!-- Format the date nicely so it's easy to read -->
                            <p class="text-muted">You submitted this on <%= new Date(survey.submission_date).toLocaleDateString() %></p>
                        </div>

                        <!-- 1. Satisfaction Question -->
                        <div class="row g-4 mb-4">
                            <div class="col-md-6 border-end-md">
                                <div class="p-2">
                                    <label class="rating-label">How satisfied were you?</label>
                                    <div class="scale-labels px-1">
                                        <span>Not Satisfied</span>
                                        <span>Very Satisfied</span>
                                    </div>
                                    <div class="d-flex justify-content-between px-2">
                                        <!-- Loop 1-5 to create radio buttons. Check the one that matches the DB score. -->
                                        <% for(let i=1; i<=5; i++) { %>
                                            <div class="form-check text-center">
                                                <input class="form-check-input" type="radio" disabled
                                                       <%= survey.score_satisfaction == i ? 'checked' : '' %>>
                                                <label class="form-check-label"><%=i%></label>
                                            </div>
                                        <% } %>
                                    </div>
                                </div>
                            </div>

                            <!-- 2. Usefulness Question -->
                            <div class="col-md-6">
                                <div class="p-2">
                                    <label class="rating-label">Was the content useful?</label>
                                    <div class="scale-labels px-1">
                                        <span>Not Useful</span>
                                        <span>Very Useful</span>
                                    </div>
                                    <div class="d-flex justify-content-between px-2">
                                        <% for(let i=1; i<=5; i++) { %>
                                            <div class="form-check text-center">
                                                <input class="form-check-input" type="radio" disabled
                                                       <%= survey.score_usefulness == i ? 'checked' : '' %>>
                                                <label class="form-check-label"><%=i%></label>
                                            </div>
                                        <% } %>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Visual Divider -->
                            <div class="w-100 d-none d-md-block border-bottom my-2"></div>

                            <!-- 3. Instructor Question -->
                            <div class="col-md-6 border-end-md">
                                <div class="p-2">
                                    <label class="rating-label">Instructor/Speaker Quality:</label>
                                    <div class="scale-labels px-1">
                                        <span>Poor</span>
                                        <span>Excellent</span>
                                    </div>
                                    <div class="d-flex justify-content-between px-2">
                                        <% for(let i=1; i<=5; i++) { %>
                                            <div class="form-check text-center">
                                                <input class="form-check-input" type="radio" disabled
                                                       <%= survey.score_instructor == i ? 'checked' : '' %>>
                                                <label class="form-check-label"><%=i%></label>
                                            </div>
                                        <% } %>
                                    </div>
                                </div>
                            </div>

                            <!-- 4. Recommend (NPS) Question -->
                            <div class="col-md-6">
                                <div class="p-2">
                                    <label class="rating-label">Likelihood to recommend?</label>
                                    <div class="scale-labels px-1">
                                        <span>Unlikely</span>
                                        <span>Very Likely</span>
                                    </div>
                                    <div class="d-flex justify-content-between px-2">
                                        <% for(let i=1; i<=5; i++) { %>
                                            <div class="form-check text-center">
                                                <input class="form-check-input" type="radio" disabled
                                                       <%= survey.score_recommendation == i ? 'checked' : '' %>>
                                                <label class="form-check-label"><%=i%></label>
                                            </div>
                                        <% } %>
                                    </div>
                                </div>
                            </div>

                            <div class="w-100 d-none d-md-block border-bottom my-2"></div>

                            <!-- 5. Overall Experience -->
                            <div class="col-md-6 border-end-md">
                                <div class="p-2">
                                    <label class="rating-label">Overall Experience:</label>
                                    <div class="scale-labels px-1">
                                        <span>Poor</span>
                                        <span>Great</span>
                                    </div>
                                    <div class="d-flex justify-content-between px-2">
                                        <% for(let i=1; i<=5; i++) { %>
                                            <div class="form-check text-center">
                                                <input class="form-check-input" type="radio" disabled
                                                       <%= survey.score_overall == i ? 'checked' : '' %>>
                                                <label class="form-check-label"><%=i%></label>
                                            </div>
                                        <% } %>
                                    </div>
                                </div>
                            </div>

                            <!-- 6. NPS Bucket (Calculated) -->
                            <!-- This shows the user if their score counted as Detractor, Passive, or Promoter -->
                            <div class="col-md-6">
                                <div class="p-2">
                                    <label class="rating-label">NPS Category</label>
                                    <div class="mb-1 d-none d-md-block" style="height: 19px;"></div> 
                                    <select class="form-select" disabled>
                                        <option value="1" <%= survey.nps_bucket_id == 1 ? 'selected' : '' %>>Detractor</option>
                                        <option value="2" <%= survey.nps_bucket_id == 2 ? 'selected' : '' %>>Passive</option>
                                        <option value="3" <%= survey.nps_bucket_id == 3 ? 'selected' : '' %>>Promoter</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- 7. Additional Comments -->
                        <div class="mb-4 bg-light p-3 rounded">
                            <label class="form-label fw-bold">Additional Comments</label>
                            <textarea class="form-control" rows="3" disabled><%= survey.comments || 'No comments provided.' %></textarea>
                        </div>

                        <!-- Navigation Button -->
                        <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                            <!-- This button is smart: if we came from the events page, it goes back there. If we came from surveys, it goes back there. -->
                            <a href="/<%= source %>" class="btn btn-outline-primary px-4">
                                <%= source === 'surveys' ? 'Back to Surveys' : 'Back to Events' %>
                            </a>
                        </div>

                    </div>
                </div>

            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>